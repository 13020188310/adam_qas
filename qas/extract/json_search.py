from flatten_json import flatten
from fuzzywuzzy import fuzz

dic = {"data":
    [
        {
            "_id":
                {
                    "$oid": "52af48b5d55148fa0c199643"},
                    "sender": "rosalee.fleming@enron.com",
                    "recipients": [ "sherri.reinartz@enron.com"],
                    "cc": [],
                    "text": "Ken will attend both meetings.\n\nRosie\n\n\n\nSherri Reinartz\n01/12/2000 03:30 PM\n\n\nTo: James M Bannantine/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Cliff \nBaxter/HOU/ECT@ECT, Sanjay Bhatnagar/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, \nRick Buy/HOU/ECT@ECT, Richard Causey/Corp/Enron@ENRON, Diomedes \nChristodoulou/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, James V Derrick@Enron, \nAndrew S Fastow/HOU/ECT@ECT, Peggy Fowler/Enron@Gateway, Mark \nFrevert/LON/ECT@ECT, Kevin P Hannon/HOU/ECT@ECT, Ken Harrison/Enron@Gateway, \nDavid Haug/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Joe Hirko/Enron \nCommunications@Enron Communications, Stanley Horton/Corp/Enron@Enron, Kurt S \nHuneke/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Larry L \nIzzo/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Steven J Kean/HOU/EES@EES, Mark \nKoenig/Corp/Enron@ENRON, Kenneth Lay/Corp/Enron@Enron, Rebecca P \nMark/HOU/AZURIX@AZURIX, Mike McConnell/HOU/ECT@ECT, Rebecca \nMcDonald/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Jeffrey McMahon/HOU/ECT@ECT, J \nMark Metts/HOU/ECT@ECT, Cindy Olson/Corp/Enron@ENRON, Lou L Pai/HOU/EES@EES, \nKenneth D Rice/HOU/ECT@ECT, Jeffrey Sherrick/Corp/Enron@Enron, John \nSherriff/LON/ECT@ECT, Jeff Skilling/Corp/Enron@ENRON, Joseph W \nSutton/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Greg Whalley/HOU/ECT@ECT, Thomas \nE White/HOU/EES@EES, Brenda \nGarza-Castillo/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Marcia \nManarin/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Susan Skarness/HOU/ECT@ECT, \nStacy Guidroz/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Beena \nPradhan/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Karen K Heathman/HOU/ECT@ECT, \nSharron Westbrook/Corp/Enron@ENRON, Molly \nBobrow/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Rosane \nFabozzi/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Stephanie \nHarris/Corp/Enron@ENRON, Bridget Maronge/HOU/ECT@ECT, Shelby \nEarle/Corp/Enron@ENRON, Shelby Earle/Corp/Enron@ENRON, Mary \nTrosper/Enron@Gateway, Nicki Daw/LON/ECT@ECT, Carol Ann Brown/HOU/ECT@ECT, \nDolly Henrici/Enron@Gateway, Ann Joyner/Corp/Enron@ENRON, Elaine \nRodriguez/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Nancy Young/Enron \nCommunications@Enron Communications, Ann Joyner/Corp/Enron@ENRON, Cindy \nStark/Corp/Enron@Enron, Sherryl Stone/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, \nMary E Garza/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Maureen \nMcVicker/HOU/EES@EES, Joannie Williamson/Corp/Enron@ENRON, Rosalee \nFleming/Corp/Enron@Enron, Vanessa Groscrand/Corp/Enron@Enron, Marsha \nLindsey/HOU/AZURIX@AZURIX, Cathy Phillips/HOU/ECT@ECT, Loretta \nBrelsford/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Sue Ford/HOU/ECT@ECT, Dolores \nFisher/HOU/ECT@ECT, Karen Owens/HOU/EES@EES, Dorothy B Dalton/HOU/ECT@ECT, \nChristina Grow/Corp/Enron@Enron, Lauren Urquhart/LON/ECT@ECT, Sherri \nReinartz/Corp/Enron@ENRON, Katherine Brown/Corp/Enron@ENRON, Pam \nBenson/ENRON_DEVELOPMENT@ENRON_DEVELOPMENT, Liz M Taylor/HOU/ECT@ECT, Judy G \nSmith@EES, Bobbie Power/Corp/Enron@ENRON\ncc: Joe Witherspoon/Corp/Enron@ENRON, Rodney Keys/Corp/Enron@ENRON, DeMonica \nLipscomb/Corp/Enron@ENRON, Vanessa Groscrand/Corp/Enron@Enron, Suzanne \nDanz/Corp/Enron@ENRON, Keith Dziadek/HOU/EES@EES \nSubject: EXECUTIVE COMMITTEE MEETINGS - MONDAY, JANUARY 17\n\nPlease respond regarding your attendance at the following events:\n\nExecutive Committee Breakfast\nDate:  Monday, January 17\nTime:  7:30 a.m.\nLocation: EB50M\n\nPlease indicate below whether or not you will attend the breakfast.\n \n  Yes, I will attend _____\n  \n  No, I will not attend _____\n\n*  *  *\n\nExecutive Committee Weekly Meeting\nDate:  Monday, January 17\nTime:  11:00 a.m. (CDT)\nLocation: 50th Floor Boardroom\nVideo:  Connections will be established with remote locations upon request.\nConf call: A conference call bridge has been reserved.  The dial in number \n713/853-3233.\n  Please contact Sherri Sera (713/853-5984) or Katherine Brown (713/345-7774)\n  for the weekly passcode.\n\nPlease indicate below whether or not you plan to attend this meeting and \nthrough what medium. \n\n Yes, I will attend in person _______\n\n By video conference from _______\n\n By conference call  _______\n\n No, I will not attend  _______\n\n*  *  *\n\nPlease return this e-mail to me with your response by 12:00 p.m., Friday, \nJanuary 14.\n\nThank you, \nSherri\n\n",
                    "mid": "18133935.1075840283210.JavaMail.evans@thyme",
                    "fpath": "enron_mail_20110402/maildir/lay-k/_sent/1.",
                    "bcc": [],
                    "to": ["sherri.reinartz@enron.com"],
                    "replyto": None,
                    "ctype": "text/plain; charset=us-ascii",
                    "fname": "1.",
                    "date": "2000-01-12 08:24:00-08:00",
                    "folder": "_sent",
                    "subject": "Re: EXECUTIVE COMMITTEE MEETINGS - MONDAY, JANUARY 17" },
        {
            "_id": { "$oid" : "52af48b5d55148fa0c199644" }, "sender" : "rosalee.fleming@enron.com", "recipients" : [ "lizard_ar@yahoo.com" ], "cc" : [], "text" : "It's done!!\n\n\n\n\nElizabeth Lay <lizard_ar@yahoo.com> on 02/02/2000 02:00:25 PM\nTo: Kenneth Lay/Corp/Enron@Enron\ncc:  \nSubject: Fwd: FW: Charges for E-mail\n\n\n\n\nRosalee, please throw away the earlier e-mail as it\nappears someone, meaning Jose Luis, didn't check their\nreferences.\nThanks\nLiz\nNote: forwarded message attached.\n\n__________________________________________________\nDo You Yahoo!?\nTalk to your friends online with Yahoo! Messenger.\nhttp://im.yahoo.com\n\nX-Apparently-To: lizard_ar@yahoo.com via web1305.mail.yahoo.com\nX-Track2: 2\nX-Track: 1: 40\nReceived: from dfw-smtpout4.email.verio.net (129.250.36.44)  by \nmta210.mail.yahoo.com with SMTP; 2 Feb 2000 19:36:26 -0000\nReceived: from [129.250.38.63] (helo=dfw-mmp3.email.verio.net) by \ndfw-smtpout4.email.verio.net with esmtp (Exim 3.12 #7) id 12G5Za-0005Rp-00 \nfor lizard_ar@yahoo.com; Wed, 02 Feb 2000 19:36:18 +0000\nReceived: from [207.197.207.102] (helo=s330.mofo.com) by \ndfw-mmp3.email.verio.net with smtp (Exim 3.12 #7) id 12G5Yt-0001uj-00 for \nlizard_ar@yahoo.com; Wed, 02 Feb 2000 19:35:35 +0000\nReceived: from 150.150.1.71 by s330.mofo.com with ESMTP (WorldSecure Server \nSMTP Relay(WSS) v4.3); Wed, 02 Feb 00 14:36:44 -0500\nX-Server-Uuid: f57e99cc-be1e-11d3-8d46-0008c7d388a4\nReceived: by S010.MOFO.COM with Internet Mail Service (5.5.2650.21) id \n<D80Y1WZ7>; Wed, 2 Feb 2000 11:36:44 -0800\nMessage-ID: <839B335DA467D211AC1E00A0C922F85406987BD3@S010.MOFO.COM>\nFrom: \"Vittor, Jose Luis\" <JLVittor@mofo.com>\nTo: \"'lizard_ar@yahoo.com'\" <lizard_ar@yahoo.com>\nSubject: FW: Charges for E-mail\nDate: Wed, 2 Feb 2000 11:36:35 -0800\nMIME-Version: 1.0\nX-Mailer: Internet Mail Service (5.5.2650.21)\nX-WSS-ID: 148658C6104679-01-01\nContent-Type: text/plain;  charset=iso-8859-1\nContent-Transfer-Encoding: quoted-printable\nContent-Length: 4394\n\n\nI am sorry honey!\nEye lobbb uuu\n\n-----Original Message-----\nFrom: Perkel, Jonathan E.\nSent: Mi,rcoles, 02 de Febrero de 2000 03:54 p.m.\nTo: Brandel, Roland E.; eLawyers; Jahn, Paul E.; Hane, Laurie S.;\nStephenson, Richard G.; Jacobs, Michael A.; Schwartz, William I.\nSubject: RE: Charges for E-mail\n\n\nI'm sorry to be the bearer of bad news, but this is a hoax:\n\nhttp://urbanlegends.about.com/culture/urbanlegends/library/blemtax2.htm\n\nHere's an excerpt from the U.S. Postal Service's published response:\n\nA completely false rumor concerning the U.S. Postal Service is being\ncirculated over the Internet via e-mail.\nThe e-mail message claims that a \"Congressman Schnell\" has introduced \"Bill\n602P\" to allow the federal government to impose a 5-cent surcharge on each\ne-mail message delivered over the Internet. The money would be collected by\nInternet Service Providers and then turned over to the Postal Service.\n\nNo such proposed legislation exists. In fact, no \"Congressman Schnell\"\nexists.\n\nJEP\n-----Original Message-----\nFrom: Brandel, Roland E.\nSent: February 02, 2000 1:24 PM\nTo: eLawyers; Jahn, Paul E.; Hane, Laurie S.; Stephenson, Richard G.;\nJacobs, Michael A.; Schwartz, William I.\nSubject: FW: Charges for E-mail\n\n\n\n\n-----Original Message-----\nFrom: DENIS T. RICE [mailto:drice@hrice.com]\nSent: February 02, 2000 10:11 AM\nTo: handg@altheimer.com; beilly@atlaslaw.com; wstutts@bakerbotts.com;\nadam.balinsky@bakernet.com; rhudson@berrymoorman.com; jrc@bizlaw.net;\nmf@blakes.ca; JMuller@brobeck.com; lengel@brobeck.com;\nsfleisher@calmed.org; Carsonph@cooley.com;\nrobyn_polashuk@corp.disney.com; mwetzler@counsel.com;\ncdt@dentonhall.com; jlmcdonnell@excitehome.net; kmurray@ffic.com;\npcoogan@fhe.com; legal@gems.vsnl.net.in; jcelniker@gj.com;\nsutina@gtlaw.com; meyer-hauser@hmp.ch; jleblanc@hollandhart.com;\nabrewster@hrice.com; adealcuaz@hrice.com; aeileraas@hrice.com;\nashames@hrice.com; ashelby@hrice.com; chall@hrice.com;\ncortmeyer@hrice.com; cvangorder@hrice.com; dschenkkan@hrice.com;\ndwinthrop@hrice.com; eschulman@hrice.com; fadam@hrice.com;\ngserota@hrice.com; hlasky@hrice.com; jboal@hrice.com;\njdawsari@hrice.com; jfaucette@hrice.com; jschaffer@hrice.com;\nkabel@hrice.com; kebanks@hrice.com; kneale@hrice.com; lfoy@hrice.com;\nlkunzebriseno@hrice.com; mweil@hrice.com; pcalande@hrice.com;\npmedina@hrice.com; progers@hrice.com; rhaas@hrice.com;\nryamini@hrice.com; scoutu@hrice.com; sdecosse@hrice.com;\nsfrankel@hrice.com; skrenek@hrice.com; anchandr@imperialbank.com;\nSonya_Sigler@intuit.com; aldrich&bonnefin@ioc.net; phil@iplegal.com;\nmjpcgolc@ix.netcom.com; mstewart@kentlaw.edu; frank_harding@kpmg.co.uk;\nheidt@law.pitt.edu; efleisch@linklaters.com; amorelli@manatt.com;\nrrings@mcleodusa.com; RBrandel@mofo.com; Peter_Willis@msj.com.au;\ns-ohsaki@nri.co.jp; gstephenson@porterwright.com; hkevane@pszy.com;\nKbrown@pszy.com; ccpitweb@public.bta.net.cn; sgamble@scwh.com;\nromanekb@sec.gov; StettnerB@sec.gov; randy.chinn@SEN.CA.GOV;\nlistings@ses.com.sg; jcs@severson.com; kjdean@sinclair-roche.com;\nwdlamb@solutia.com; caw@steelhector.com; laura.clayton@sun.com;\nwtgay@swlaw.com; mkurtz@us.oracle.com;\njonathan.rosenoer@us.pwcglobal.com; lynn.holmes@usa.net;\nlawtech@well.com; achandra@worldnet.att.net; pgneilan@worldnet.att.net;\nharoldf@zipcon.net\nSubject: Fwd: Charges for E-mail\n\n\nThreats to the \"Net\n\n____________________________________________\n\nThis message and any files or text attached to it are intended only for the\nrecipients named above, and contain information that may be confidential or\nprivileged.  If you are not an intended recipient, you must not read, copy,\nuse or disclose this communication.  Please also notify the sender by\nreplying to this message, and then delete all copies of it from your system.\nThank you.\n\n_____________________________________________\n\n\n======================================\n\nThis message contains information which may be confidential and privileged.\nUnless you are the addressee (or authorized to receive for the addressee),\nyou may not use, copy or disclose to anyone the message or any information\ncontained in the message.  If you have received the message in error, please\nadvise the sender by reply e-mail @mofo.com, and delete the message.\nThank you very much.\n\n======================================\n\n\n\n", "mid" : "2156358.1075840283423.JavaMail.evans@thyme", "fpath" : "enron_mail_20110402/maildir/lay-k/_sent/10.", "bcc" : [], "to" : [ "lizard_ar@yahoo.com" ], "replyto" : None, "ctype" : "text/plain; charset=us-ascii", "fname" : "10.", "date" : "2000-02-02 06:48:00-08:00", "folder" : "_sent", "subject" : "Re: Fwd: FW: Charges for E-mail" },
        {
            "_id": { "$oid" : "52af48b5d55148fa0c199645" }, "sender" : "rosalee.fleming@enron.com", "recipients" : [ "rob.bradley@enron.com" ], "cc" : [], "text" : "Oh, Rob, I'm happy to do so!!  I hope you are on vacation!!\n\nRosie\n\n\n\n\nRob Bradley\n08/04/2000 01:27 PM\nTo: Kenneth Lay/Corp/Enron@ENRON\ncc:  \nSubject: Re: Gathering Place Speaking Invitation  \n\nGreat--and I will be inspired with my draft of his remarks.\n\nRosie, could you call the phone number on the invitation, ask for Herb \nBateman (he is the director), and tell him of the commitment?\n\nI am out of town and do not have their number, and they called me wondering \nabout Ken's decision last Friday.\n\nThanks,\n\n- Rob\n\n\n\n\nKenneth Lay on 08/04/2000 12:40:45 PM\nSent by: Rosalee Fleming\nTo: Rob Bradley/Corp/Enron@ENRON\ncc: Tori L Wells/HOU/ECT@ECT \n\nSubject: Re: Gathering Place Speaking Invitation  \n\nHi Rob -\n\nKen said \"If you'll prepare the remarks, I'll be happy to do this\".\n\nRosie\n\n\nRob Bradley\n07/19/2000 09:51 AM\n\n\nTo: Kenneth Lay/Corp/Enron@ENRON\ncc:  \nSubject: Gathering Place Speaking Invitation\n\nIf you are inclined to accept this invitation, we could put together an \ninteresting talk on the importance of good mental health to business with \nsome national statistics and then segue into Enron's emphasis on wellness and \nhaving fun in the workplace.  Our strategy and experience will be very \ninteresting to the group since it shows what a corporate leader is doing to \nbecome the employer of choice in the marketplace.\n\nYou could expect a full house (around 400) for the talk.  If it fits into \nyour schedule, Jack Bowen said he would be delighted to be honorary chairman \nof the event.\n\n- Rob\n\n\n\n\n\n\n", "mid" : "20840329.1075840285588.JavaMail.evans@thyme", "fpath" : "enron_mail_20110402/maildir/lay-k/_sent/100.", "bcc" : [], "to" : [ "rob.bradley@enron.com" ], "replyto" : None, "ctype" : "text/plain; charset=us-ascii", "fname" : "100.", "date" : "2000-08-04 08:52:00-07:00", "folder" : "_sent", "subject" : "Re: Gathering Place Speaking Invitation" },
    ]
}

fdic = flatten(dic)
num_list = [str(i) for i in range(0, 10)]
term = "name"

for fkey, fval in fdic.items():
    # print(fkey, ":", fdic[fkey])
    print(fkey)
    fkey_list = fkey.split("_")
    # print(fkey_list)
    # print(num_list)
    result = [key for key in fkey_list if key not in num_list]
    relative_match = fuzz.ratio(term, " ".join(result))
    absolute_match = fuzz.ratio(term, " ".join(result[len(result) - 1]))
    match = ((relative_match + absolute_match) / 200) * 100
    print(term+" ==> "+str(result)+" : "+str(match))

